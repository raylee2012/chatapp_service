<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.chatapp_main.mapper.ContactMapper">

  <select id="selectContactByContactores" resultType="com.example.chatapp_main.pojo.Contact">
    select * from contact where applicant_id=#{applicant_id} and receiver_id=#{receiver_id}
  </select>

  <select id="getApplicantList" resultMap="applicant">
    SELECT user.`user_id`,user.`user_name`,user.`imgurl`,user.`nick_name`,contact.`application_content`,contact.`status`,contact.`update_time` FROM user,contact WHERE user.`user_id`=contact.`applicant_id` AND contact.`receiver_id`=#{receiver_id};
  </select>

  <resultMap id="applicant" type="com.example.chatapp_main.pojo.Applicant">
    <result property="application_content" column="application_content"/>
    <result property="status" column="status"/>
    <result property="update_time" column="update_time"/>
    <collection  property="user"  ofType="com.example.chatapp_main.pojo.User">
      <result property="user_id" column="user_id"/>
      <result property="user_name" column="user_name"/>
      <result property="imgurl" column="imgurl"/>
      <result property="nick_name" column="nick_name"/>
    </collection>
  </resultMap>



  <select id="selectContactByPrimaryKey" resultType="com.example.chatapp_main.pojo.Contact">
    select * from contact where contact_id=#{contact_id}
  </select>

  <update id="updateContactInfo" parameterType="com.example.chatapp_main.pojo.Contact">
        update contact
      <trim prefix="set" suffixOverrides=",">
        <if test="applicant_id!=null">applicant_id=#{applicant_id},</if>
        <if test="receiver_id!=null">receiver_id=#{receiver_id},</if>
        <if test="application_content!=null">application_content=#{application_content},</if>
        <if test="status!=null">status=#{status},</if>
        <if test="update_time!=null">update_time=#{update_time},</if>
      </trim>
      WHERE contact_id=#{contact_id}
  </update>

  <insert id="insertSelective" parameterType="com.example.chatapp_main.pojo.Contact">
    insert into contact
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="contact_id != null">
        contact_id,
      </if>
      <if test="applicant_id != null">
        applicant_id,
      </if>
      <if test="receiver_id != null">
        receiver_id,
      </if>
      <if test="application_content != null">
        application_content,
      </if>
      <if test="status != null">
        status,
      </if>
      <if test="create_time != null">
        create_time,
      </if>
      <if test="update_time != null">
        update_time,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="contact_id != null">
        #{contact_id},
      </if>
      <if test="applicant_id != null">
        #{applicant_id},
      </if>
      <if test="receiver_id != null">
        #{receiver_id},
      </if>
      <if test="application_content != null">
        #{application_content},
      </if>
      <if test="status != null">
        #{status},
      </if>
      <if test="create_time != null">
        #{create_time},
      </if>
      <if test="update_time != null">
        #{update_time},
      </if>
    </trim>
  </insert>
</mapper>